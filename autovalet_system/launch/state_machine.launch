<launch>

    <arg name="simulation" default="true"/>

    <group if="$(arg simulation)">
        <node name="SLAM" pkg="autovalet_system" type="slam_sim.sh" />
        <node name="NAVIGATION" pkg="autovalet_system" type="nav_sim.sh" />

        <include file="$(find autovalet_gazebo)/launch/aruco_sim.launch">
            <arg name="markerId" value="7" />
            <arg name="markerSize" value="0.5" />
            <arg name="ref_frame" value="/base_link" />
        </include>

        <node pkg="nodelet" type="nodelet" name="nodelet_manager" args="manager" />

        <node pkg="nodelet" type="nodelet" name="nodelet1" args="load depth_image_proc/register nodelet_manager">
            <remap from="depth/camera_info" to="/frontCamera/depth/camera_info"/>
            <remap from="rgb/camera_info" to="/frontCamera/color/camera_info"/>
            <remap from="depth/image_rect" to="/frontCamera/depth/image_raw"/>
        </node>


        <node name="STATE_MACHINE" pkg="autovalet_system" type="sm_sim.sh" />
    </group>

    <group unless="$(arg simulation)">
        <node name="SLAM" pkg="autovalet_system" type="slam_husky.sh" />
        <node name="NAVIGATION" pkg="autovalet_system" type="nav_husky.sh" />

        <include file="$(find autovalet_husky)/launch/aruco_hardware.launch"/>

        <node pkg="autovalet_system" type="autovalet_system.py" name="STATE_MACHINE" args="False"/>

    </group>
</launch>
